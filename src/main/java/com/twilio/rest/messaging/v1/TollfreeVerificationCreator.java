/**
 * This code was generated by
 * \ / _    _  _|   _  _
 *  | (_)\/(_)(_|\/| |(/_  v1.0.0
 *       /       /
 */

package com.twilio.rest.messaging.v1;

import com.twilio.base.Creator;
import com.twilio.converter.Promoter;
import com.twilio.exception.ApiConnectionException;
import com.twilio.exception.ApiException;
import com.twilio.exception.RestException;
import com.twilio.http.HttpMethod;
import com.twilio.http.Request;
import com.twilio.http.Response;
import com.twilio.http.TwilioRestClient;
import com.twilio.rest.Domains;

import java.util.List;

/**
 * PLEASE NOTE that this class contains beta products that are subject to
 * change. Use them with caution.
 */
public class TollfreeVerificationCreator extends Creator<TollfreeVerification> {
    private final String businessName;
    private final String businessWebsite;
    private final String notificationEmail;
    private final List<String> useCaseCategories;
    private final String useCaseSummary;
    private final String productionMessageSample;
    private final List<String> optInImageUrls;
    private final TollfreeVerification.OptInType optInType;
    private final String messageVolume;
    private final String tollfreePhoneNumberSid;
    private String customerProfileSid;
    private String businessStreetAddress;
    private String businessStreetAddress2;
    private String businessCity;
    private String businessStateProvinceRegion;
    private String businessPostalCode;
    private String businessCountry;
    private String additionalInformation;
    private String businessContactFirstName;
    private String businessContactLastName;
    private String businessContactEmail;
    private com.twilio.type.PhoneNumber businessContactPhone;

    /**
     * Construct a new TollfreeVerificationCreator.
     *
     * @param businessName The name of the business or organization using the
     *                     Tollfree number
     * @param businessWebsite The website of the business or organization using the
     *                        Tollfree number
     * @param notificationEmail The email address to receive the notification about
     *                          the verification result.
     * @param useCaseCategories The category of the use case for the Tollfree
     *                          Number. List as many are applicable.
     * @param useCaseSummary Further explaination on how messaging is used by the
     *                       business or organization
     * @param productionMessageSample An example of message content, i.e. a sample
     *                                message
     * @param optInImageUrls Link to an image that shows the opt-in workflow.
     *                       Multiple images allowed and must be a publicly hosted
     *                       URL
     * @param optInType Describe how a user opts-in to text messages
     * @param messageVolume Estimate monthly volume of messages from the Tollfree
     *                      Number
     * @param tollfreePhoneNumberSid The SID of the Phone Number associated with
     *                               the Tollfree Verification
     */
    public TollfreeVerificationCreator(final String businessName,
                                       final String businessWebsite,
                                       final String notificationEmail,
                                       final List<String> useCaseCategories,
                                       final String useCaseSummary,
                                       final String productionMessageSample,
                                       final List<String> optInImageUrls,
                                       final TollfreeVerification.OptInType optInType,
                                       final String messageVolume,
                                       final String tollfreePhoneNumberSid) {
        this.businessName = businessName;
        this.businessWebsite = businessWebsite;
        this.notificationEmail = notificationEmail;
        this.useCaseCategories = useCaseCategories;
        this.useCaseSummary = useCaseSummary;
        this.productionMessageSample = productionMessageSample;
        this.optInImageUrls = optInImageUrls;
        this.optInType = optInType;
        this.messageVolume = messageVolume;
        this.tollfreePhoneNumberSid = tollfreePhoneNumberSid;
    }

    /**
     * Customer's Profile Bundle BundleSid..
     *
     * @param customerProfileSid Customer's Profile Bundle BundleSid
     * @return this
     */
    public TollfreeVerificationCreator setCustomerProfileSid(final String customerProfileSid) {
        this.customerProfileSid = customerProfileSid;
        return this;
    }

    /**
     * The address of the business or organization using the Tollfree number..
     *
     * @param businessStreetAddress The address of the business or organization
     *                              using the Tollfree number
     * @return this
     */
    public TollfreeVerificationCreator setBusinessStreetAddress(final String businessStreetAddress) {
        this.businessStreetAddress = businessStreetAddress;
        return this;
    }

    /**
     * The address of the business or organization using the Tollfree number..
     *
     * @param businessStreetAddress2 The address of the business or organization
     *                               using the Tollfree number
     * @return this
     */
    public TollfreeVerificationCreator setBusinessStreetAddress2(final String businessStreetAddress2) {
        this.businessStreetAddress2 = businessStreetAddress2;
        return this;
    }

    /**
     * The city of the business or organization using the Tollfree number..
     *
     * @param businessCity The city of the business or organization using the
     *                     Tollfree number
     * @return this
     */
    public TollfreeVerificationCreator setBusinessCity(final String businessCity) {
        this.businessCity = businessCity;
        return this;
    }

    /**
     * The state/province/region of the business or organization using the Tollfree
     * number..
     *
     * @param businessStateProvinceRegion The state/province/region of the business
     *                                    or organization using the Tollfree number
     * @return this
     */
    public TollfreeVerificationCreator setBusinessStateProvinceRegion(final String businessStateProvinceRegion) {
        this.businessStateProvinceRegion = businessStateProvinceRegion;
        return this;
    }

    /**
     * The postal code of the business or organization using the Tollfree number..
     *
     * @param businessPostalCode The postal code of the business or organization
     *                           using the Tollfree number
     * @return this
     */
    public TollfreeVerificationCreator setBusinessPostalCode(final String businessPostalCode) {
        this.businessPostalCode = businessPostalCode;
        return this;
    }

    /**
     * The country of the business or organization using the Tollfree number..
     *
     * @param businessCountry The country of the business or organization using the
     *                        Tollfree number
     * @return this
     */
    public TollfreeVerificationCreator setBusinessCountry(final String businessCountry) {
        this.businessCountry = businessCountry;
        return this;
    }

    /**
     * Additional information to be provided for verification..
     *
     * @param additionalInformation Additional information to be provided for
     *                              verification
     * @return this
     */
    public TollfreeVerificationCreator setAdditionalInformation(final String additionalInformation) {
        this.additionalInformation = additionalInformation;
        return this;
    }

    /**
     * The first name of the contact for the business or organization using the
     * Tollfree number..
     *
     * @param businessContactFirstName The first name of the contact for the
     *                                 business or organization using the Tollfree
     *                                 number
     * @return this
     */
    public TollfreeVerificationCreator setBusinessContactFirstName(final String businessContactFirstName) {
        this.businessContactFirstName = businessContactFirstName;
        return this;
    }

    /**
     * The last name of the contact for the business or organization using the
     * Tollfree number..
     *
     * @param businessContactLastName The last name of the contact for the business
     *                                or organization using the Tollfree number
     * @return this
     */
    public TollfreeVerificationCreator setBusinessContactLastName(final String businessContactLastName) {
        this.businessContactLastName = businessContactLastName;
        return this;
    }

    /**
     * The email address of the contact for the business or organization using the
     * Tollfree number..
     *
     * @param businessContactEmail The email address of the contact for the
     *                             business or organization using the Tollfree
     *                             number
     * @return this
     */
    public TollfreeVerificationCreator setBusinessContactEmail(final String businessContactEmail) {
        this.businessContactEmail = businessContactEmail;
        return this;
    }

    /**
     * The phone number of the contact for the business or organization using the
     * Tollfree number..
     *
     * @param businessContactPhone The phone number of the contact for the business
     *                             or organization using the Tollfree number
     * @return this
     */
    public TollfreeVerificationCreator setBusinessContactPhone(final com.twilio.type.PhoneNumber businessContactPhone) {
        this.businessContactPhone = businessContactPhone;
        return this;
    }

    /**
     * The phone number of the contact for the business or organization using the
     * Tollfree number..
     *
     * @param businessContactPhone The phone number of the contact for the business
     *                             or organization using the Tollfree number
     * @return this
     */
    public TollfreeVerificationCreator setBusinessContactPhone(final String businessContactPhone) {
        return setBusinessContactPhone(Promoter.phoneNumberFromString(businessContactPhone));
    }

    /**
     * Make the request to the Twilio API to perform the create.
     *
     * @param client TwilioRestClient with which to make the request
     * @return Created TollfreeVerification
     */
    @Override
    @SuppressWarnings("checkstyle:linelength")
    public TollfreeVerification create(final TwilioRestClient client) {
        Request request = new Request(
            HttpMethod.POST,
            Domains.MESSAGING.toString(),
            "/v1/Tollfree/Verifications"
        );

        addPostParams(request);
        Response response = client.request(request);

        if (response == null) {
            throw new ApiConnectionException("TollfreeVerification creation failed: Unable to connect to server");
        } else if (!TwilioRestClient.SUCCESS.test(response.getStatusCode())) {
            RestException restException = RestException.fromJson(response.getStream(), client.getObjectMapper());
            if (restException == null) {
                throw new ApiException("Server Error, no content");
            }
            throw new ApiException(restException);
        }

        return TollfreeVerification.fromJson(response.getStream(), client.getObjectMapper());
    }

    /**
     * Add the requested post parameters to the Request.
     *
     * @param request Request to add post params to
     */
    private void addPostParams(final Request request) {
        if (businessName != null) {
            request.addPostParam("BusinessName", businessName);
        }

        if (businessWebsite != null) {
            request.addPostParam("BusinessWebsite", businessWebsite);
        }

        if (notificationEmail != null) {
            request.addPostParam("NotificationEmail", notificationEmail);
        }

        if (useCaseCategories != null) {
            for (String prop : useCaseCategories) {
                request.addPostParam("UseCaseCategories", prop);
            }
        }

        if (useCaseSummary != null) {
            request.addPostParam("UseCaseSummary", useCaseSummary);
        }

        if (productionMessageSample != null) {
            request.addPostParam("ProductionMessageSample", productionMessageSample);
        }

        if (optInImageUrls != null) {
            for (String prop : optInImageUrls) {
                request.addPostParam("OptInImageUrls", prop);
            }
        }

        if (optInType != null) {
            request.addPostParam("OptInType", optInType.toString());
        }

        if (messageVolume != null) {
            request.addPostParam("MessageVolume", messageVolume);
        }

        if (tollfreePhoneNumberSid != null) {
            request.addPostParam("TollfreePhoneNumberSid", tollfreePhoneNumberSid);
        }

        if (customerProfileSid != null) {
            request.addPostParam("CustomerProfileSid", customerProfileSid);
        }

        if (businessStreetAddress != null) {
            request.addPostParam("BusinessStreetAddress", businessStreetAddress);
        }

        if (businessStreetAddress2 != null) {
            request.addPostParam("BusinessStreetAddress2", businessStreetAddress2);
        }

        if (businessCity != null) {
            request.addPostParam("BusinessCity", businessCity);
        }

        if (businessStateProvinceRegion != null) {
            request.addPostParam("BusinessStateProvinceRegion", businessStateProvinceRegion);
        }

        if (businessPostalCode != null) {
            request.addPostParam("BusinessPostalCode", businessPostalCode);
        }

        if (businessCountry != null) {
            request.addPostParam("BusinessCountry", businessCountry);
        }

        if (additionalInformation != null) {
            request.addPostParam("AdditionalInformation", additionalInformation);
        }

        if (businessContactFirstName != null) {
            request.addPostParam("BusinessContactFirstName", businessContactFirstName);
        }

        if (businessContactLastName != null) {
            request.addPostParam("BusinessContactLastName", businessContactLastName);
        }

        if (businessContactEmail != null) {
            request.addPostParam("BusinessContactEmail", businessContactEmail);
        }

        if (businessContactPhone != null) {
            request.addPostParam("BusinessContactPhone", businessContactPhone.toString());
        }
    }
}